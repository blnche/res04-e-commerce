<?php
    // Récupère les données des catégories et des produits depuis la variable $this->data
    $categories = $this->data["categories"];
    $products = $this->data["products"];
    var_dump($_SESSION["user_id"]);
    var_dump($_SESSION["cart"]);
    $route = $_GET["route"];
?>

<aside id="categories">
    <h2>Catégories</h2>
    <ul>
    <?php
        // Boucle à travers toutes les catégories et les affiche en tant qu'éléments de liste
        foreach($categories as $category)
        {
    ?> 
            <li><?=$category->getName();?></li>
    <?php
        }
    ?>
    </ul>
    <form method="POST" action="index.php?route=homepage-filtered">
         <input type="hidden" name="formName" value="getProductCategory"/>
         <label for="category_list">Quelle catégorie ?</label>
         <select name="category_list" id="category_list">
             <?php 
            foreach($categories as $category)
            {   
            ?>
                <option value="<?= $category->getId(); ?>"> <?= $category->getName(); ?> </option>
            <?php
            }
        ?>
        </select>
        <input type="submit" value="Submit"> 
        <a href="index.php?route=homepage">Voir tous les livres</a>
     </form>
</aside>
<section id="products">
    <h2>Produits</h2>
    <?php
        require "cart.phtml";
        // Affiche les 10 premiers produits dans une boucle
        for($i=0; $i<10; $i++)
        {
    ?> 
        <form id="addItem" method="POST" action="index.php?route=cart&action=add">
            <input type="hidden" name="formName" value="product_order"/>
            
            <article class="card">
                <h3><?= $products[$i]->getName(); ?></h3>
                <img width="200" src="<?= $products[$i]->getUrlMedia(); ?>" alt="oui il en faudrait un">
                <p><?= $products[$i]->getDescription(); ?></p>
                <span><?= $products[$i]->getPrice(); ?>€</span>
            </article>
            
            <input type="hidden" name="product-id" id="product-id" value="<?= $products[$i]->getId(); ?>"/>
            <input type="number" name="quantity" id="product-quantity" value="1" size="2"/>
            <input type="submit" value="Ajouter au panier"/>
        </form>
    <?php
        }
    ?>
</section>
